<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">

	<title>Using the SDK Document</title>

	<link rel="stylesheet" href="../css/style.css">
	<meta name="viewport" content="initial-scale=1, maximum-scale=1.4">
	<meta name="generator" content="appledoc 2.2.1 (build 1333)">
</head>
<body class="appledoc">
	<header>
		<div class="container" class="hide-in-xcode">
			
			<h1 id="library-title">
				<a href="../index.html">BeaconForStore SDK </a>
			</h1>

			<p id="developer-home">
				<a href="../index.html">Ezeeworld</a>
			</p>
			
		</div>
	</header>

	<aside>
		<div class="container">
			<nav>
				<ul id="header-buttons" role="toolbar">
					<li><a href="../index.html">Home</a></li>
				</ul>
			</nav>
		</div>
	</aside>

	<article>
		<div id="overview-contents" class="container">
			<div id="content">
				<main role="main">
					<h1 class="title">Using the SDK Document</h1>

					<h2>Import the umbrella header In your AppDelegate.h (Objective-C only) :</h2>

<pre><code>#import &lt;BeaconForStoreSDK/BeaconForStoreSDK.h&gt;
</code></pre>

<h2>Import the Framework in your Bridging-Header.h file (Swift only)</h2>

<pre><code>#import &lt;BeaconForStoreSDK/BeaconForStoreSDK.h&gt;
</code></pre>

<h2>Implement B4SDelegate in your app delegate (Objective-C only)</h2>

<pre><code>@interface AppDelegate : UIResponder &lt;UIApplicationDelegate,B4SDelegate&gt;    
</code></pre>

<h2>Initialize the Framework in the application:didFinishLaunchingWithOptions: method:</h2>

<p>Objective-C:</p>

<pre><code>//Add an observer for the B4S SDK notification processed event.
[[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(notificationProcessed:) name:kB4SNotificationProcessedNotification object:nil];

//Replace MY-APP-ID with the ID associated with your BeaconForStore account
B4SSingleton *b4sSingleton = [B4SSingleton setupSharedInstanceWithAppId:@"MY-APP-ID" adminMode:NO];
[b4sSingleton B4SsetPeriodicBeaconsUpdate:NO];
[B4SSingleton sharedInstance].delegate = self;
[[B4SSingleton sharedInstance] startStandAloneMode];

// Use this method to change the sound played when you app shows a notification to the user
// The sound file must be in .caf (Core Audio File) format and imported into your project
[b4sSingleton setNotificationSoundname:@"sound.caf"];
</code></pre>

<p>Swift:</p>

<pre><code>//Add an observer for the B4S SDK notification processed event.
NSNotificationCenter.defaultCenter().addObserver(self, selector: "notificationProcessed:", name: kB4SNotificationProcessedNotification, object: nil)

//Replace MY-APP-ID with the ID associated to your beacon4store account
let b4sSingleton = B4SSingleton.setupSharedInstanceWithAppId("MY-APP-ID")
B4SSingleton.sharedInstance().delegate = self;
B4SSingleton.sharedInstance().startStandAloneMode()

// Use this method to change the sound played when you app shows a notification to the user
// The sound file must be in .caf (Core Audio File) format and imported into your project
b4sSingleton.notificationSoundname = "sound.caf"
</code></pre>

<h2>Decoding notifications</h2>

<p>The SDK uses local notifications to establish communication between beacons and the app.</p>

<p>Implement the application:didReceiveLocalNotification: method in your appDelegate. A notification will be sent by the SDK when a notification is fired. You can use the UILocalNotification.userInfo to process the notification yourself. But if you set up some automatic action in the B4S setup application, you must call the <a href="../Classes/B4SSingleton.html#//api/name/notificationFeedback:">[B4SSingleton notificationFeedback:]</a> method. So, the SDK will display a confirmation panel (if any) and process one of the requested predefined actions.</p>

<p>Objective-C:</p>

<pre><code>- (void)application:(UIApplication *)application didReceiveLocalNotification:(UILocalNotification *)notification
{
    NSLog(@"[didReceiveLocalNotification] %@ / %@",[notification.userInfo objectForKey:kB4SNotifBeaconId],[notification.userInfo objectForKey:kB4SNotifContentName]);
    NSLog(@"notification : %@",notification.description);
    self.lastNotification = notification;

    // If you want to use B4S SDK internal notification processing (UIAlertView, UIWebView, open Url in Safari, ...), you must call
    // the B4SSingleton:notificationFeedback: method.
    [[B4SSingleton sharedInstance] notificationFeedback:notification.userInfo];
}
</code></pre>

<p>Swift:</p>

<pre><code>func application(application: UIApplication, didReceiveLocalNotification notification: UILocalNotification) {
{
    println("[didReceiveLocalNotification] \(notification.userInfo?[kB4SNotifBeaconId]) / \(notification.userInfo?[kB4SNotifContentName)")
    println("notification : \(notification.description)");

    // If you want to use B4S SDK internal notification processing (UIAlertView, UIWebView, open Url in Safari, ...), you have to call
    // the B4SSingleton:notificationFeedback: method.
    B4SSingleton.sharedInstance().notificationFeedback(notification.userInfo?)
    // After post processing made through the notificationFeedback method, the delegate:notificationProcessed will be called.
}
</code></pre>

<p>After processing a notification, a kB4SNotificationProcessedNotification event is fired by the SDK. The notification type is a B4SActionType that you can get using [[notificationData.userInfo objectForKey:kB4SNotifActionId] intValue]</p>

<h2>Record user data</h2>

<p>B4S can relate beacon interactions tot individual customers. Supplying the customer details is typically done on startup and/or after a user signed in to his/her account. In these cases you can update te SDK with this customer data (which is persisted; no need to call every time) using the <a href="../Classes/B4SSingleton.html#//api/name/setUserName:firstName:gender:email:customerRef:">[B4SSingleton setUserName:firstName:gender:email:customerRef:]</a></p>

<h2>Application tagging</h2>

<p>You can tag your application with the B4S SDK. You can set two values : The first parameter is the event descriptor and the second the userData asociated to the event.</p>

<pre><code>[B4STag event:@"Test" userData:@"test"];
</code></pre>

<h2>B4S Behaviours</h2>

<p>This feature allows you to automatically warn the user if Bluetooth, notifications or geolocation are disabled. This setup <strong>must</strong> be done before initializing the B4S Singleton.</p>

<pre><code>[B4SBehaviours warnForBluetooth:true after:0 count:2 andEvery:2 withTitle:@"Bluetooth" andText:@"Bluetooth is disabled. Do you want to enabled it ?"];
[B4SBehaviours warnForGeolocation:true after:3 count:2 andEvery:2 withTitle:@"Geoloc" andText:@"Geolocation is disabled. Do you want to enable it ?"];
[B4SBehaviours warnForNotifications:true after:1 count:2 andEvery:2 withTitle:@"Notifications " andText:@"Notifications are disabled. You need to activate them in order to use this application."];
</code></pre>

<h2>Customize notifications</h2>

<p>You can customize the notification messages and data sent to your application by implementing the <a href="../Protocols/B4SDelegate.html#//api/name/customizeNotificationText:andData:andUserInfo:completion:">[B4SDelegate customizeNotificationText:andData:andUserInfo:completion:]</a> method in your appDelegate</p>

<p>Objective-C:</p>

<pre><code>- (void)customizeNotificationText:(NSString *)aText
                          andData:(NSString *)aData
                      andUserInfo:(NSMutableDictionary *)userInfos
                       completion:(void (^)(NSString *pushText, NSString *pushData, NSMutableDictionary *userInfos))completion {
    if (completion) {
        NSLog(@"[customizeNotificationText] set notification text with braces");
        completion([NSString stringWithFormat:@"[%@]",aText], aData, userInfos);
    }
}
</code></pre>

<p>Swift:</p>

<pre><code>func customizeNotificationText(aText: String!, andData aData: String!, andUserInfo userInfos: NSMutableDictionary!, completion: ((String!, String!, NSMutableDictionary!) -&gt; Void)!) {
    if completion != nil {
        println("[customizeNotificationText] set notification text with braces")
        completion("[\(aText)]", aData, userInfos)
    }
}
</code></pre>

					<footer>
						<div class="footer-copyright">
							
							<p class="copyright">Copyright &copy; 2015 Ezeeworld. All rights reserved. Updated: 2015-09-07</p>
							
							
							<p class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.2.1 (build 1333)</a>.</p>
							
						</div>
					</footer>
				</main>
			</div>
		</div>
	</article>

	<script src="../js/script.js"></script>
</body>
</html>